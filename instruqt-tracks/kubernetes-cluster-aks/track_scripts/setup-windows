# Install Chocolatey
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072

# Install Powershell 7
C:\ProgramData\chocolatey\choco.exe install -y powershell-core

# Install Visual Studio Code
C:\ProgramData\chocolatey\choco.exe install -y vscode vscode-powershell

# Install git
C:\ProgramData\chocolatey\choco.exe install -y git

# Install azure CLI
C:\ProgramData\chocolatey\choco.exe install -y azure-cli

# Update PATH variable
$oldpath = (Get-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment' -Name PATH).path
$newpath = "$oldpath;C:\Program Files\Git\bin; C:\Program Files (x86)\Microsoft SDKs\Azure\CLI2\wbin"
$env:PATH += ";C:\Program Files\Git\bin; C:\Program Files (x86)\Microsoft SDKs\Azure\CLI2\wbin"
Set-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment' -Name PATH -Value $newPath